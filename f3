import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.metrics import classification_report, confusion_matrix

# --- 1. Get Model Predictions ---
# We get the raw probability outputs from the model
y_pred_probs = model.predict(X_test)

# We find the class with the highest probability for each sample
# This converts the one-hot format [0.1, 0.8, 0.1] into a single label '1'
y_pred_labels = np.argmax(y_pred_probs, axis=1)

# We must also convert the true y_test labels from one-hot to single labels
y_true_labels = np.argmax(y_test, axis=1)

# --- 2. Generate Classification Report ---
print("\n--- Classification Report ---")
# 'le.classes_' provides the actual string names (e.g., 'hungry', 'pain')
print(classification_report(y_true_labels, y_pred_labels, target_names=le.classes_))


# --- 3. Generate Confusion Matrix ---
print("\n--- Plotting Confusion Matrix ---")
cm = confusion_matrix(y_true_labels, y_pred_labels)

# Plot the confusion matrix using Seaborn
plt.figure(figsize=(10, 8))
sns.heatmap(cm,
            annot=True, # Show the numbers in each cell
            fmt='d',    # Format numbers as integers
            cmap='Blues',
            xticklabels=le.classes_,
            yticklabels=le.classes_)

plt.title('Confusion Matrix', fontsize=16)
plt.ylabel('True Label', fontsize=12)
plt.xlabel('Predicted Label', fontsize=12)
plt.show()
